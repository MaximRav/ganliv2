<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/navibar.css" />
    <link rel="stylesheet" href="/ganTamp.css" />
    <title>קטנטנים</title>
</head>

<body>
    <header>
        <bar>
            <ul>
                <li><a href="/selfPage" id="selfPageLink">אזור אישי</a></li>
                <li><a href="/ganimlist.html">גנים</a></li>
                <li><a href="/aboutPage.html">אודות</a></li>
                <li><a href="/HomeLog.html">בית</a></li>
                <li><a href="/HomeLog.html" class="logo">גן-לי</a></li>
                <li>
                    <a href="/logout" class="login" id="logoutLink">התנתקות</a>
                </li>
            </ul>
        </bar>
    </header>
    <main class="inner">
        <section class="frame-group">
            <div class="frame-container">
                <div class="frame-div">
                    <div class="frame-parent1">
                        <div class="rectangle-group">
                            <div class="frame-item"></div>
                            <div class="container">
                                <div class="div5">:התראות מן הגן</div>
                            </div>
                            <div class="div6">
                                <p class="p"></p>
                            </div>
                        </div>
                        <div class="frame-parent2">
                            <div class="rectangle-container">
                                <div class="frame-inner"></div>
                                <div class="div7">:חזון הגן</div>
                                <div class="div8">
                                    <p class="p2">בגן הילדים שלנו, אנו חולמים על סביבה חינוכית חמה ומעוררת השראה. חזוננו
                                        הוא לספק לכל ילד את ההזדמנות להתפתח בצורה מלאה וטבעית.

                                        הגן יהיה מקום שבו תוכל כל ילד להרגיש בטוח ומובטח, מוקף באהבה ותמיכה. נעסוק
                                        בפיתוח כישורים רגשיים וחברתיים דרך פעילויות מגוונות ומעוררות השראה.

                                        נקדם ערכים של כבוד, אחריות ושיתוף פעולה, כדי לחיבור וליצירת קהילה חינוכית חזקה
                                        ומאושרת.

                                        בגן נעבוד יחד עם הורים כפרטנרים חשובים בתהליך החינוכי, ונקדם שיתוף פעולה פתוח
                                        ואמין על מנת לקדם את רכישת הילדים בכישורים ובערכים הדרושים לצמיחה פורה ומוצלחת.

                                        חזוננו הוא ליצור גן ילדים המעודד את הילדים להתפתח בכל תחומי החיים באופן פעיל,
                                        יצירתי ומהנה.</p>
                                </div>
                            </div>
                            <div class="rectangle-parent1">
                                <div class="rectangle-div"></div>
                                <div class="div9">:עקרונות הגן</div>
                                <div class="div10">
                                    <ol class="ol">
                                        <li class="li">ביטחון ובריאות הילד: שמירה על בריאותם ובטיחותם של הילדים כשהם בגן
                                            היא עיקריים. זה כולל תנאים בריאים ובטוחים במתן תשומת הלב לצרכי הבריאות של כל
                                            ילד.

                                            פיתוח רגשי וחברתי: יצירת סביבה המקדמת יכולת להבנה של רגשות, יכולת לשלוט בהם
                                            ובעבודה בקבוצה. זה מסייע לילדים לפתח יחסים חברתיים חיוביים וללמוד לתקשר
                                            בצורה בריאה.

                                            למידה פעילה וחווייתית: יצירת סביבה המעודדת למידה דרך חוויות ופעילויות
                                            משמעותיות ומעניינות, שמקדמות את התפתחותם האקדמית והקוגניטיבית של הילדים.

                                            התאמה אישית וקבוצתית: עיקריות בגיל הרך היא כישורי ההתאמה והבנת כישורים של כל
                                            ילד בנפרד וקבוצתית. זה כולל ניהול כיתה בצורה שמתעסקת בצרכים האישיים של
                                            הילדים.</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="frame-parent3">
                    <div class="rectangle-parent2">
                        <div class="frame-child1"></div>
                        <div class="div10">
                            <span>שם הגן:</span>
                            <span class="span">קטנטנים</span>
                        </div>
                        <div class="div11">
                            <span>שם הגננת:</span>
                            <span class="span">ליאורה שטראוס</span>
                        </div>
                        <div class="div13">
                            <span>שנת הקמה:</span>
                            <span class="span2">2021</span>
                        </div>
                        <div class="div14">
                            <span>אופי הגן:</span>
                            <span class="span3">חילוני</span>
                        </div>
                        <div class="div16">
                            <span>מספר ילדים:</span>
                            <span class="span5">3</span>
                        </div>
                        <div class="div17">
                            <span>מחיר:</span>
                            <span class="span6">3000</span>
                        </div>
                        <div class="div19">
                            <p class="p4">
                                <span class="span8">שעות פעילות:</span>
                                <span> </span>
                            </p>
                            <p class="p5">8:00-15:30</p>
                        </div>
                    </div>
                    <iframe
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1705.4297494400644!2d34.778862261424194!3d31.252312586582548!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x15026674c538be3f%3A0x7939e5214c0bf039!2z16ki15kg16LXkteg15XXnyA0LCDXkdeQ16gg16nXkdei!5e0!3m2!1siw!2sil!4v1712701468571!5m2!1siw!2sil"
                        width="400" height="400" style="border:0;" allowfullscreen="" loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"></iframe>
                </div>
            </div>
            <div class="rectangle-parent3">
                <div class="rectangle-parent4">
                    <div class="frame-child3"></div>
                    <div class="frame-parent4" id="reviewsContainer">
                        <!-- Reviews will be dynamically added here -->
                    </div>
                    <div class="frame">
                        <div class="div23">הוסף ביקורת</div>
                        <form id="reviewForm">
                            <textarea id="reviewText" rows="4" cols="50"></textarea>
                            <button type="submit">שלח</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <!--REPLACE_WITH_ADMIN_BUTTONS-->
</body>
<script>
    // Get the user's role from the server
    fetch('/profile')
        .then(response => response.json())
        .then(data => {
            const userRole = data.role;
            const selfPageLink = document.getElementById('selfPageLink');

            // Update the selfPageLink based on the user's role
            if (userRole === 'הורה') {
                selfPageLink.href = '/selfPageP.html';
            } else if (userRole === 'גננת') {
                selfPageLink.href = '/selfPageG.html';
            } else if (userRole === 'admin') {
                selfPageLink.href = '/selfPageA.html';
            }

            // Check if the user is an admin
            if (userRole === 'admin') {
                // Inject the edit and delete buttons for admin users
                const adminButtonsContainer = document.createElement('div');
                adminButtonsContainer.innerHTML = `

                            `;
                document.body.appendChild(adminButtonsContainer);
            }
        })
        .catch(error => {
            console.error('Error fetching user role:', error);
        });

    // Function to edit a gan
    function editGan(ganId) {
        window.location.href = `/editGan.html?ganId=${ganId}`;
    }

    // Function to delete a gan
    function deleteGan(ganId) {
        if (confirm('האם אתה בטוח שברצונך למחוק את הגן?')) {
            fetch(`/gans/${ganId}`, { method: 'DELETE' })
                .then(response => {
                    if (response.ok) {
                        alert('הגן נמחק בהצלחה');
                        window.location.href = '/ganimlist.html';
                    } else {
                        alert('שגיאה במחיקת הגן');
                    }
                })
                .catch(error => {
                    console.error('Error deleting gan:', error);
                    alert('שגיאה במחיקת הגן');
                });
        }
    }

    function fetchAndDisplayReviews(ganName) {
        fetch(`/gans/${ganName}`)
            .then(response => response.json())
            .then(gan => {
                const reviewsContainer = document.getElementById('reviewsContainer');
                reviewsContainer.innerHTML = '';
                gan.reviews.forEach(review => {
                    const reviewDiv = document.createElement('div');
                    reviewDiv.classList.add('review');
                    const authorSpan = document.createElement('span');
                    authorSpan.textContent = `${review.author}: `;
                    reviewDiv.appendChild(authorSpan);
                    const reviewText = document.createElement('p');
                    reviewText.textContent = review.text;
                    reviewDiv.appendChild(reviewText);
                    reviewsContainer.appendChild(reviewDiv);
                });
            })
            .catch(error => {
                console.error('Error fetching reviews:', error);
            });
    }

    function addReview(ganName) {
        const reviewText = document.getElementById('reviewText').value.trim();
        if (reviewText) {
            fetch(`/gans/${ganName}/review`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ review: reviewText }),
                credentials: 'include'
            })
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error('Error adding review');
                    }
                })
                .then(updatedGan => {
                    document.getElementById('reviewText').value = '';
                    fetchAndDisplayReviews(ganName);
                })
                .catch(error => {
                    console.error('Error adding review:', error);
                    alert('שגיאה בהוספת הביקורת');
                });
        }
    }

    // Add event listener to the review form
    const reviewForm = document.getElementById('reviewForm');
    reviewForm.addEventListener('submit', event => {
        event.preventDefault();
        addReview('קטנטנים');
    });

    // Fetch and display reviews when the page loads
    fetchAndDisplayReviews('קטנטנים');

</script>

</html>